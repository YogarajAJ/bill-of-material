generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL") // make sure this is defined in .env
}

model User {
  id       String  @id @default(uuid())
  username String  @unique
  password String
  role     Role
}

model Product {
  id          String   @id @default(uuid())
  name        String
  code        String   @unique
  description String?
  status      Status   @default(Active)
  createdAt   DateTime @default(now())
  boms        BOM[]
}

model Material {
  id    String @id @default(uuid())
  name  String
  code  String @unique
  type  String?
  items BOMItem[]
}

model Unit {
  id        String @id @default(uuid())
  name      String
  shortName String
  items     BOMItem[]
}

model Supplier {
  id      String @id @default(uuid())
  name    String
  code    String @unique
  address String?
  items   BOMItem[]
}

model BOM {
  id            String     @id @default(uuid())
  name          String
  effectiveFrom DateTime
  revision      Int
  createdAt     DateTime   @default(now())
  product       Product    @relation(fields: [productId], references: [id])
  productId     String
  items         BOMItem[]
}

model BOMItem {
  id            String   @id @default(uuid())
  quantity      Float
  referenceCode String?
  bom           BOM      @relation(fields: [bomId], references: [id])
  bomId         String
  material      Material @relation(fields: [materialId], references: [id])
  materialId    String
  unit          Unit     @relation(fields: [unitId], references: [id])
  unitId        String
  supplier      Supplier @relation(fields: [supplierId], references: [id])
  supplierId    String
}

enum Role {
  Admin
  Designer
}

enum Status {
  Active
  Inactive
}
